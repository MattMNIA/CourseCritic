import{r as f,h as F,j as e,i as W,u as T,e as H,C as k,A as p,B as v,a as P,R as L,f as g,k as U,l as A,d as G,F as D,b as O}from"./index-DX5mPb-7.js";import{P as $,C as M}from"./ProfessorSearch-BsAgSYVd.js";import{m as V,F as t}from"./Form-D-AHDBBl.js";import"./courseService-BtXvpxST.js";const I=1e3;function z(o,a,n){const c=(o-a)/(n-a)*100;return Math.round(c*I)/I}function R({min:o,now:a,max:n,label:c,visuallyHidden:r,striped:i,animated:u,className:d,style:x,variant:l,bsPrefix:m,...h},j){return e.jsx("div",{ref:j,...h,role:"progressbar",className:W(d,`${m}-bar`,{[`bg-${l}`]:l,[`${m}-bar-animated`]:u,[`${m}-bar-striped`]:u||i}),style:{width:`${z(a,o,n)}%`,...x},"aria-valuenow":a,"aria-valuemin":o,"aria-valuemax":n,children:r?e.jsx("span",{className:"visually-hidden",children:c}):c})}const B=f.forwardRef(({isChild:o=!1,...a},n)=>{const c={min:0,max:100,animated:!1,visuallyHidden:!1,striped:!1,...a};if(c.bsPrefix=F(c.bsPrefix,"progress"),o)return R(c,n);const{min:r,now:i,max:u,label:d,visuallyHidden:x,striped:l,animated:m,bsPrefix:h,variant:j,className:w,children:b,...N}=c;return e.jsx("div",{ref:n,...N,className:W(w,h),children:b?V(b,s=>f.cloneElement(s,{isChild:!0})):R({min:r,now:i,max:u,label:d,visuallyHidden:x,striped:l,animated:m,bsPrefix:h,variant:j},n)})});B.displayName="ProgressBar";const J={submitReview:async o=>{const a=await fetch("/api/review",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!a.ok){const n=await a.json();throw new Error(n.message||"Failed to submit review")}return await a.json()}},Q=()=>{const[o,a]=f.useState(1),[n,c]=f.useState(!1),[r,i]=f.useState({courseId:"",difficulty:3,hoursPerWeek:3,usefulness:3,professorId:"",courseComments:"",comments:""}),[u,d]=f.useState({});T();const{currentUniversity:x}=H(),l=7,m=o/l*100,h=()=>{const s={};switch(o){case 1:r.courseId||(s.courseId="Please select a course");break;case 2:r.difficulty||(s.difficulty="Please rate the difficulty");break;case 3:r.hoursPerWeek<1&&(s.hoursPerWeek="Please enter valid hours");break;case 4:r.usefulness||(s.usefulness="Please rate the usefulness");break;case 5:r.professorId||(s.professor="Please enter the professor name");break}return d(s),Object.keys(s).length===0},j=()=>{h()&&a(s=>Math.min(s+1,l))},w=()=>{a(s=>Math.max(s-1,1))},b=async s=>{var C,S;if(s.preventDefault(),h())try{const y=O.getCurrentUser();if(!y){d({submit:"You must be logged in to submit a review"});return}const E={courseId:r.courseId,userId:y.id,professorId:r.professorId,difficulty:r.difficulty,hoursPerWeek:r.hoursPerWeek,usefulness:r.usefulness,courseComments:r.courseComments,comments:r.comments};await J.submitReview(E),c(!0),i({courseId:"",difficulty:3,hoursPerWeek:3,usefulness:3,professorId:"",courseComments:"",comments:""}),a(1)}catch(y){d({submit:((S=(C=y.response)==null?void 0:C.data)==null?void 0:S.error)||"Failed to submit review"})}},N=()=>{switch(o){case 1:return e.jsxs(t.Group,{className:"mb-4",children:[e.jsx(t.Label,{children:"Search for Course"}),e.jsx(M,{onSelect:s=>i({...r,courseId:(s==null?void 0:s.id)||""}),error:u.courseId}),e.jsx(t.Text,{className:"text-muted",children:"Search for the course you'd like to review"})]});case 2:return e.jsxs(t.Group,{className:"mb-4",children:[e.jsx(t.Label,{children:"Course Difficulty"}),e.jsx("div",{className:"d-flex justify-content-between mb-2",children:[1,2,3,4,5].map(s=>e.jsxs("div",{onClick:()=>i({...r,difficulty:s}),className:"text-center",style:{cursor:"pointer"},children:[e.jsx(D,{size:32,color:s<=r.difficulty?"#dc3545":"#e4e5e9"}),e.jsxs("div",{className:"mt-1 small",children:[s===1&&"Very Easy",s===2&&"Easy",s===3&&"Moderate",s===4&&"Hard",s===5&&"Very Hard"]})]},s))}),e.jsx(t.Text,{className:"text-muted",children:"Rate how difficult you found this course"})]});case 3:return e.jsxs(t.Group,{className:"mb-4",children:[e.jsx(t.Label,{children:"Hours per Week"}),e.jsx(t.Range,{min:"1",max:"20",value:r.hoursPerWeek,onChange:s=>i({...r,hoursPerWeek:parseInt(s.target.value)})}),e.jsxs("div",{className:"text-center mb-2",children:[r.hoursPerWeek," hours"]}),e.jsx(t.Text,{className:"text-muted",children:"Estimate the average number of hours spent per week on this course"})]});case 4:return e.jsxs(t.Group,{className:"mb-4",children:[e.jsx(t.Label,{children:"Course Usefulness"}),e.jsx("div",{className:"d-flex justify-content-between mb-2",children:[1,2,3,4,5].map(s=>e.jsxs("div",{onClick:()=>i({...r,usefulness:s}),className:"text-center",style:{cursor:"pointer"},children:[e.jsx(G,{size:32,color:s<=r.usefulness?"#ffc107":"#e4e5e9"}),e.jsx("div",{className:"mt-1",children:s})]},s))}),e.jsx(t.Text,{className:"text-muted",children:"Rate how useful you found this course (1 = Not Useful, 5 = Very Useful)"})]});case 5:return e.jsxs(t.Group,{className:"mb-4",children:[e.jsx(t.Label,{children:"Professor Name"}),e.jsx($,{onSelect:s=>i({...r,professorId:s?s.id:""}),error:u.professor}),e.jsx(t.Text,{className:"text-muted",children:"Who taught this course when you took it?"})]});case 6:return e.jsxs(t.Group,{className:"mb-4",children:[e.jsx(t.Label,{children:"Course-Specific Comments"}),e.jsx(t.Control,{as:"textarea",rows:3,value:r.courseComments,onChange:s=>i({...r,courseComments:s.target.value}),placeholder:"What should students know about this specific course?"}),e.jsx(t.Text,{className:"text-muted",children:"Share specific details about assignments, exams, or course structure"})]});case 7:return e.jsxs(t.Group,{className:"mb-4",children:[e.jsx(t.Label,{children:"Additional Comments"}),e.jsx(t.Control,{as:"textarea",rows:4,value:r.comments,onChange:s=>i({...r,comments:s.target.value}),placeholder:"Share your overall experience with future students..."}),e.jsx(t.Text,{className:"text-muted",children:"Any other advice or thoughts about the course?"})]})}};return n?e.jsx(k,{className:"py-5",children:e.jsxs(p,{variant:"success",children:[e.jsx(p.Heading,{children:"Review Submitted Successfully!"}),e.jsx("p",{children:"Thank you for sharing your experience."}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-end",children:[e.jsx(v,{variant:"outline-success",onClick:()=>c(!1),className:"me-2",children:"Write Another Review"}),e.jsx(v,{variant:"success",href:"/",children:"Return to Home"})]})]})}):e.jsxs(k,{className:"py-4",children:[x?e.jsx(p,{variant:"info",className:"mb-4",children:e.jsxs(p.Heading,{as:"h5",children:["Writing review for ",x.name]})}):e.jsx(p,{variant:"warning",className:"mb-4",children:"Please select a university from the dropdown menu in the navigation bar to submit a review."}),e.jsx(P,{children:e.jsxs(P.Body,{children:[e.jsx("h2",{className:"text-center mb-4",children:"Course Review"}),e.jsx(B,{now:m,className:"mb-4"}),e.jsxs(t,{onSubmit:b,children:[N(),e.jsxs(L,{className:"mt-4",children:[e.jsx(g,{children:o>1&&e.jsxs(v,{variant:"outline-primary",onClick:w,children:[e.jsx(U,{className:"me-2"}),"Back"]})}),e.jsx(g,{className:"text-end",children:o<l?e.jsxs(v,{variant:"primary",onClick:j,children:["Next",e.jsx(A,{className:"ms-2"})]}):e.jsx(v,{variant:"success",type:"submit",children:"Submit Review"})})]})]})]})})]})};export{Q as default};
