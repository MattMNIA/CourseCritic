import{r as n,h as j,m as De,n as ze,o as _,j as t,i as C,p as Ue,q as _e,s as ae,t as Oe,v as He,w as Ge,x as We,y as se,M as Ke,z as Pe,D as Ve,E as ne,G as qe,H as Je,I as Qe,B as F,u as Xe,e as Ye,J as U,b as te}from"./index-DX5mPb-7.js";import{c as Ze}from"./courseService-BtXvpxST.js";import{F as M}from"./Form-D-AHDBBl.js";function es(e){const s=n.useRef(e);return s.current=e,s}function ss(e){const s=es(e);n.useEffect(()=>()=>s.current(),[])}const le=n.forwardRef(({bsPrefix:e,active:s,disabled:l,eventKey:r,className:i,variant:d,action:h,as:m,...f},o)=>{e=j(e,"list-group-item");const[u,y]=De({key:ze(r,f.href),active:s,...f}),w=_(g=>{if(l){g.preventDefault(),g.stopPropagation();return}u.onClick(g)});l&&f.tabIndex===void 0&&(f.tabIndex=-1,f["aria-disabled"]=!0);const c=m||(h?f.href?"a":"button":"div");return t.jsx(c,{ref:o,...f,...u,onClick:w,className:C(i,e,y.isActive&&"active",l&&"disabled",d&&`${e}-${d}`,h&&`${e}-action`)})});le.displayName="ListGroupItem";const ie=n.forwardRef((e,s)=>{const{className:l,bsPrefix:r,variant:i,horizontal:d,numbered:h,as:m="div",...f}=Ue(e,{activeKey:"onSelect"}),o=j(r,"list-group");let u;return d&&(u=d===!0?"horizontal":`horizontal-${d}`),t.jsx(_e,{ref:s,...f,as:m,className:C(l,o,i&&`${o}-${i}`,u&&`${o}-${u}`,h&&`${o}-numbered`)})});ie.displayName="ListGroup";const B=Object.assign(ie,{Item:le});var E;function re(e){if((!E&&E!==0||e)&&ae){var s=document.createElement("div");s.style.position="absolute",s.style.top="-9999px",s.style.width="50px",s.style.height="50px",s.style.overflow="scroll",document.body.appendChild(s),E=s.offsetWidth-s.clientWidth,document.body.removeChild(s)}return E}function ts(){return n.useState(null)}const ce=n.forwardRef(({className:e,bsPrefix:s,as:l="div",...r},i)=>(s=j(s,"modal-body"),t.jsx(l,{ref:i,className:C(e,s),...r})));ce.displayName="ModalBody";const O=n.forwardRef(({bsPrefix:e,className:s,contentClassName:l,centered:r,size:i,fullscreen:d,children:h,scrollable:m,...f},o)=>{e=j(e,"modal");const u=`${e}-dialog`,y=typeof d=="string"?`${e}-fullscreen-${d}`:`${e}-fullscreen`;return t.jsx("div",{...f,ref:o,className:C(u,s,i&&`${e}-${i}`,r&&`${u}-centered`,m&&`${u}-scrollable`,d&&y),children:t.jsx("div",{className:C(`${e}-content`,l),children:h})})});O.displayName="ModalDialog";const de=n.forwardRef(({className:e,bsPrefix:s,as:l="div",...r},i)=>(s=j(s,"modal-footer"),t.jsx(l,{ref:i,className:C(e,s),...r})));de.displayName="ModalFooter";const ue=n.forwardRef(({bsPrefix:e,className:s,closeLabel:l="Close",closeButton:r=!1,...i},d)=>(e=j(e,"modal-header"),t.jsx(Oe,{ref:d,...i,className:C(s,e),closeLabel:l,closeButton:r})));ue.displayName="ModalHeader";const rs=He("h4"),fe=n.forwardRef(({className:e,bsPrefix:s,as:l=rs,...r},i)=>(s=j(s,"modal-title"),t.jsx(l,{ref:i,className:C(e,s),...r})));fe.displayName="ModalTitle";function os(e){return t.jsx(ne,{...e,timeout:null})}function as(e){return t.jsx(ne,{...e,timeout:null})}const me=n.forwardRef(({bsPrefix:e,className:s,style:l,dialogClassName:r,contentClassName:i,children:d,dialogAs:h=O,"data-bs-theme":m,"aria-labelledby":f,"aria-describedby":o,"aria-label":u,show:y=!1,animation:w=!0,backdrop:c=!0,keyboard:g=!0,onEscapeKeyDown:v,onShow:x,onHide:N,container:b,autoFocus:L=!0,enforceFocus:T=!0,restoreFocus:p=!0,restoreFocusOptions:I,onEntered:pe,onExit:H,onExiting:ye,onEnter:G,onEntering:W,onExited:K,backdropClassName:P,manager:V,...ge},we)=>{const[ve,Ce]=n.useState({}),[je,q]=n.useState(!1),A=n.useRef(!1),D=n.useRef(!1),R=n.useRef(null),[k,xe]=ts(),Ne=Ge(we,xe),J=_(N),Se=We();e=j(e,"modal");const Me=n.useMemo(()=>({onHide:J}),[J]);function Q(){return V||qe({isRTL:Se})}function X(a){if(!ae)return;const S=Q().getScrollbarWidth()>0,ee=a.scrollHeight>Ve(a).documentElement.clientHeight;Ce({paddingRight:S&&!ee?re():void 0,paddingLeft:!S&&ee?re():void 0})}const z=_(()=>{k&&X(k.dialog)});ss(()=>{se(window,"resize",z),R.current==null||R.current()});const Ie=()=>{A.current=!0},Re=a=>{A.current&&k&&a.target===k.dialog&&(D.current=!0),A.current=!1},Y=()=>{q(!0),R.current=Qe(k.dialog,()=>{q(!1)})},ke=a=>{a.target===a.currentTarget&&Y()},$e=a=>{if(c==="static"){ke(a);return}if(D.current||a.target!==a.currentTarget){D.current=!1;return}N==null||N()},be=a=>{g?v==null||v(a):(a.preventDefault(),c==="static"&&Y())},Ee=(a,S)=>{a&&X(a),G==null||G(a,S)},Fe=a=>{R.current==null||R.current(),H==null||H(a)},Be=(a,S)=>{W==null||W(a,S),Je(window,"resize",z)},Le=a=>{a&&(a.style.display=""),K==null||K(a),se(window,"resize",z)},Te=n.useCallback(a=>t.jsx("div",{...a,className:C(`${e}-backdrop`,P,!w&&"show")}),[w,P,e]),Z={...l,...ve};Z.display="block";const Ae=a=>t.jsx("div",{role:"dialog",...a,style:Z,className:C(s,e,je&&`${e}-static`,!w&&"show"),onClick:c?$e:void 0,onMouseUp:Re,"data-bs-theme":m,"aria-label":u,"aria-labelledby":f,"aria-describedby":o,children:t.jsx(h,{...ge,onMouseDown:Ie,className:r,contentClassName:i,children:d})});return t.jsx(Ke.Provider,{value:Me,children:t.jsx(Pe,{show:y,ref:Ne,backdrop:c,container:b,keyboard:!0,autoFocus:L,enforceFocus:T,restoreFocus:p,restoreFocusOptions:I,onEscapeKeyDown:be,onShow:x,onHide:N,onEnter:Ee,onEntering:Be,onEntered:pe,onExit:Fe,onExiting:ye,onExited:Le,manager:Q(),transition:w?os:void 0,backdropTransition:w?as:void 0,renderBackdrop:Te,renderDialog:Ae})})});me.displayName="Modal";const $=Object.assign(me,{Body:ce,Header:ue,Title:fe,Footer:de,Dialog:O,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),he=({onSelect:e,error:s,placeholder:l,fetchItems:r,filterItems:i,renderItem:d,getDisplayValue:h,label:m,disabled:f})=>{const[o,u]=n.useState(""),[y,w]=n.useState([]),[c,g]=n.useState([]),[v,x]=n.useState(!1),[N,b]=n.useState(null);n.useEffect(()=>{(async()=>{try{const I=await r();w(I)}catch(I){console.error("Failed to load items:",I)}})()},[r]),n.useEffect(()=>{if(o.length>1){const p=i(y,o);g(p),x(!0)}else g([]),x(!1)},[o,y,i]);const L=p=>{b(p),u(h(p)),e(p),x(!1)},T=()=>{b(null),u(""),e(null)};return t.jsx("div",{className:"position-relative",children:N?t.jsxs("div",{className:"d-flex align-items-center border rounded p-2",children:[t.jsx("div",{className:"flex-grow-1",children:d(N)}),t.jsxs(F,{variant:"outline-secondary",size:"sm",onClick:T,className:"ms-2",children:["Change ",m]})]}):t.jsxs(t.Fragment,{children:[t.jsx(M.Control,{type:"text",placeholder:l,value:o,onChange:p=>u(p.target.value),isInvalid:!!s,disabled:f}),t.jsx(M.Control.Feedback,{type:"invalid",children:s}),v&&t.jsx(B,{className:"position-absolute w-100 mt-1 shadow-sm",style:{zIndex:1e3},children:c.length>0?c.map(p=>t.jsx(B.Item,{action:!0,onClick:()=>L(p),className:"cursor-pointer",children:d(p)},p.id)):t.jsxs(B.Item,{disabled:!0,children:["No ",m.toLowerCase()," found"]})})]})})},cs=({onSelect:e,error:s})=>{const l=Xe(),{currentUniversity:r}=Ye(),i=async()=>r!=null&&r.id?Ze.searchCourses({universityId:r.id}):[],d=(o,u)=>o.filter(y=>y.course_name.toLowerCase().includes(u.toLowerCase())||y.course_code.toLowerCase().includes(u.toLowerCase())),h=o=>t.jsxs(B.Item,{action:!0,onClick:()=>f(o),className:"d-flex justify-content-between align-items-center",children:[t.jsx("div",{className:"fw-bold",children:o.course_code}),t.jsx("small",{children:o.course_name})]},o.id),m=o=>`${o.course_code} - ${o.course_name}`,f=o=>{e?e(o):l(`/courses/${o.id}`)};return t.jsx(he,{onSelect:e,error:s,placeholder:r?"Search for a course...":"Select a university first",fetchItems:i,filterItems:d,renderItem:h,getDisplayValue:m,label:"Course",disabled:!r},(r==null?void 0:r.id)||"no-university")},oe={getAllProfessors:async()=>{try{return(await U.get("/professors")).data}catch(e){throw console.error("Failed to fetch professors:",e),e}},getProfessorsByUniversity:async e=>{try{return(await U.get(`/professors/university/${e}`)).data}catch(s){throw console.error("Failed to fetch university professors:",s),s}},createProfessor:async(e,s)=>{try{return(await U.post("/professors",{name:e,universityId:s})).data}catch(l){throw console.error("Failed to create professor:",l),l}}},ds=({onSelect:e,error:s})=>{const[l,r]=n.useState(!1),[i,d]=n.useState(""),[h,m]=n.useState(""),f=async()=>{var c,g;try{if(m(""),!i.trim()){m("Professor name is required");return}const v=te.getCurrentUser(),x=await oe.createProfessor(i.trim(),v.university_id);e(x),r(!1),d("")}catch(v){m(((g=(c=v.response)==null?void 0:c.data)==null?void 0:g.error)||"Failed to create professor")}},o=async()=>{const c=te.getCurrentUser();return c!=null&&c.university_id?oe.getProfessorsByUniversity(c.university_id):[]},u=(c,g)=>c.filter(v=>v.name.toLowerCase().includes(g.toLowerCase())),y=c=>t.jsx("div",{className:"fw-bold",children:c.name}),w=c=>c.name;return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"d-flex gap-2",children:[t.jsx("div",{className:"flex-grow-1",children:t.jsx(he,{onSelect:e,error:s,placeholder:"Search for a professor...",fetchItems:o,filterItems:u,renderItem:y,getDisplayValue:w,label:"Professor"})}),t.jsx(F,{variant:"outline-secondary",onClick:()=>r(!0),className:"flex-shrink-0",children:"Add New"})]}),t.jsxs($,{show:l,onHide:()=>r(!1),children:[t.jsx($.Header,{closeButton:!0,children:t.jsx($.Title,{children:"Add New Professor"})}),t.jsx($.Body,{children:t.jsxs(M.Group,{children:[t.jsx(M.Label,{children:"Professor Name"}),t.jsx(M.Control,{type:"text",value:i,onChange:c=>d(c.target.value),placeholder:"Enter professor's name",isInvalid:!!h}),t.jsx(M.Control.Feedback,{type:"invalid",children:h})]})}),t.jsxs($.Footer,{children:[t.jsx(F,{variant:"secondary",onClick:()=>r(!1),children:"Cancel"}),t.jsx(F,{variant:"primary",onClick:f,children:"Add Professor"})]})]})]})};export{cs as C,ds as P};
